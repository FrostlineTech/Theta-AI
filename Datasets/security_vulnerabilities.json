[
  {
    "type": "vulnerability",
    "category": "injection",
    "name": "SQL Injection",
    "cwe_id": "CWE-89",
    "severity": "critical",
    "description": "Improper neutralization of special elements used in SQL commands allows attackers to manipulate database queries.",
    "attack_vector": "User input concatenated directly into SQL query strings",
    "impact": ["data_breach", "data_modification", "authentication_bypass", "privilege_escalation"],
    "vulnerable_pattern": "SELECT * FROM users WHERE name = '\" + userInput + \"'",
    "secure_pattern": "cursor.execute('SELECT * FROM users WHERE name = ?', (userInput,))",
    "detection_methods": ["static_analysis", "dynamic_testing", "code_review"],
    "mitigation": ["parameterized_queries", "input_validation", "least_privilege", "waf"],
    "real_world_example": "Heartland Payment Systems breach (2008) - 130M credit cards exposed"
  },
  {
    "type": "vulnerability",
    "category": "injection",
    "name": "Cross-Site Scripting (XSS)",
    "cwe_id": "CWE-79",
    "severity": "high",
    "description": "Injection of malicious scripts into web pages viewed by other users.",
    "attack_vector": "User-controlled data rendered in HTML without proper encoding",
    "impact": ["session_hijacking", "credential_theft", "defacement", "malware_distribution"],
    "vulnerable_pattern": "<div>Welcome, <%= userName %></div>",
    "secure_pattern": "<div>Welcome, <%= escapeHtml(userName) %></div>",
    "detection_methods": ["browser_devtools", "burp_suite", "automated_scanners"],
    "mitigation": ["output_encoding", "content_security_policy", "httponly_cookies", "input_validation"],
    "real_world_example": "British Airways breach (2018) - Magecart XSS skimmed 380K payment cards"
  },
  {
    "type": "vulnerability",
    "category": "authentication",
    "name": "Broken Authentication",
    "cwe_id": "CWE-287",
    "severity": "critical",
    "description": "Weak authentication mechanisms allowing unauthorized access to accounts.",
    "attack_vector": "Credential stuffing, brute force, session hijacking, weak password policies",
    "impact": ["account_takeover", "identity_theft", "unauthorized_access"],
    "vulnerable_pattern": "No rate limiting, predictable session tokens, passwords stored in plaintext",
    "secure_pattern": "MFA, bcrypt hashing, secure session management, account lockout",
    "detection_methods": ["penetration_testing", "credential_testing", "session_analysis"],
    "mitigation": ["mfa", "strong_password_policy", "secure_session_management", "rate_limiting"],
    "real_world_example": "Yahoo breach (2013-2014) - 3B accounts compromised via forged cookies"
  },
  {
    "type": "vulnerability",
    "category": "access_control",
    "name": "Insecure Direct Object Reference (IDOR)",
    "cwe_id": "CWE-639",
    "severity": "high",
    "description": "Direct access to objects based on user-supplied input without authorization checks.",
    "attack_vector": "Manipulating IDs in URLs or API calls to access other users' data",
    "impact": ["data_breach", "privacy_violation", "unauthorized_modification"],
    "vulnerable_pattern": "GET /api/invoice/12345 - returns invoice without checking ownership",
    "secure_pattern": "Verify user owns resource before returning: if invoice.owner != current_user: return 403",
    "detection_methods": ["manual_testing", "burp_suite", "parameter_tampering"],
    "mitigation": ["authorization_checks", "indirect_references", "access_control_lists"],
    "real_world_example": "First American Financial (2019) - 885M records exposed via IDOR"
  },
  {
    "type": "vulnerability",
    "category": "cryptography",
    "name": "Sensitive Data Exposure",
    "cwe_id": "CWE-311",
    "severity": "high",
    "description": "Failure to properly protect sensitive data in transit or at rest.",
    "attack_vector": "Network sniffing, database breach, log file access",
    "impact": ["data_breach", "compliance_violation", "identity_theft"],
    "vulnerable_pattern": "Storing passwords in MD5, transmitting over HTTP, logging sensitive data",
    "secure_pattern": "TLS 1.3, bcrypt/argon2 for passwords, encryption at rest, no sensitive logging",
    "detection_methods": ["traffic_analysis", "database_inspection", "log_review"],
    "mitigation": ["encryption_in_transit", "encryption_at_rest", "key_management", "data_classification"],
    "real_world_example": "Equifax breach (2017) - 147M SSNs exposed due to unpatched vulnerability"
  },
  {
    "type": "vulnerability",
    "category": "injection",
    "name": "Command Injection",
    "cwe_id": "CWE-78",
    "severity": "critical",
    "description": "Execution of arbitrary system commands through vulnerable application.",
    "attack_vector": "User input passed to system shell without sanitization",
    "impact": ["remote_code_execution", "system_compromise", "data_exfiltration"],
    "vulnerable_pattern": "os.system('ping ' + user_input)",
    "secure_pattern": "subprocess.run(['ping', user_input], shell=False)",
    "detection_methods": ["code_review", "fuzzing", "penetration_testing"],
    "mitigation": ["avoid_shell_calls", "input_validation", "least_privilege", "sandboxing"],
    "real_world_example": "Shellshock (2014) - Bash vulnerability affected millions of servers"
  },
  {
    "type": "vulnerability",
    "category": "deserialization",
    "name": "Insecure Deserialization",
    "cwe_id": "CWE-502",
    "severity": "critical",
    "description": "Untrusted data deserialized without validation, leading to code execution.",
    "attack_vector": "Malicious serialized objects passed to application",
    "impact": ["remote_code_execution", "denial_of_service", "privilege_escalation"],
    "vulnerable_pattern": "pickle.loads(user_data), ObjectInputStream.readObject()",
    "secure_pattern": "JSON parsing, signature verification, type whitelisting",
    "detection_methods": ["code_review", "gadget_chain_analysis", "dynamic_testing"],
    "mitigation": ["avoid_native_serialization", "input_validation", "integrity_checks"],
    "real_world_example": "Apache Struts (2017) - RCE via OGNL deserialization"
  },
  {
    "type": "vulnerability",
    "category": "configuration",
    "name": "Security Misconfiguration",
    "cwe_id": "CWE-16",
    "severity": "medium",
    "description": "Insecure default configurations, incomplete setups, or overly verbose error messages.",
    "attack_vector": "Exploiting default credentials, exposed admin panels, verbose errors",
    "impact": ["information_disclosure", "unauthorized_access", "system_compromise"],
    "vulnerable_pattern": "DEBUG=True in production, default admin/admin credentials",
    "secure_pattern": "Hardened configs, disabled debug mode, changed defaults, minimal error info",
    "detection_methods": ["configuration_audit", "scanning", "penetration_testing"],
    "mitigation": ["secure_defaults", "configuration_management", "regular_audits"],
    "real_world_example": "Capital One (2019) - Misconfigured WAF led to 100M record breach"
  },
  {
    "type": "vulnerability",
    "category": "access_control",
    "name": "Privilege Escalation",
    "cwe_id": "CWE-269",
    "severity": "high",
    "description": "Gaining elevated access beyond what was originally granted.",
    "attack_vector": "Exploiting flaws in permission checks, role assignment, or trust boundaries",
    "impact": ["admin_access", "data_breach", "system_control"],
    "vulnerable_pattern": "Checking role on client side, trusting user-provided role claims",
    "secure_pattern": "Server-side authorization, principle of least privilege, role verification",
    "detection_methods": ["access_control_testing", "role_manipulation", "code_review"],
    "mitigation": ["server_side_checks", "least_privilege", "separation_of_duties"],
    "real_world_example": "SolarWinds (2020) - Attackers escalated to domain admin"
  },
  {
    "type": "vulnerability",
    "category": "web",
    "name": "Server-Side Request Forgery (SSRF)",
    "cwe_id": "CWE-918",
    "severity": "high",
    "description": "Attacker can make server perform requests to unintended locations.",
    "attack_vector": "User-controlled URLs passed to server-side HTTP client",
    "impact": ["internal_network_access", "cloud_metadata_theft", "service_abuse"],
    "vulnerable_pattern": "requests.get(user_provided_url)",
    "secure_pattern": "URL allowlisting, disable redirects, network segmentation",
    "detection_methods": ["out_of_band_testing", "url_manipulation", "metadata_access_testing"],
    "mitigation": ["url_validation", "allowlisting", "network_segmentation", "metadata_protection"],
    "real_world_example": "Capital One SSRF to AWS metadata endpoint leaked credentials"
  }
]
