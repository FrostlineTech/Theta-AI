[
  {
    "type": "error_handling",
    "category": "principle",
    "pattern": "fail_fast",
    "description": "Detect and report errors as early as possible",
    "rationale": "Early failure is easier to debug than silent corruption propagating through system",
    "examples": {
      "good": "Validate input at API boundary, throw immediately on invalid",
      "bad": "Accept any input, handle nulls/invalids deep in business logic"
    },
    "implementation": ["input_validation", "null_checks", "assertions", "type_checking"],
    "exceptions": "Performance-critical paths may defer validation"
  },
  {
    "type": "error_handling",
    "category": "principle",
    "pattern": "specific_exceptions",
    "description": "Catch specific exceptions, not generic Exception/Throwable",
    "rationale": "Generic catches hide bugs and make debugging difficult",
    "examples": {
      "bad": "try: ... except: pass",
      "good": "try: ... except ValueError as e: handle_validation(e)"
    },
    "python": "except (ValueError, TypeError) as e:",
    "java": "catch (IOException | SQLException e)",
    "javascript": "Check error type in catch block: if (e instanceof ValidationError)"
  },
  {
    "type": "error_handling",
    "category": "principle", 
    "pattern": "dont_swallow_exceptions",
    "description": "Never catch and ignore exceptions silently",
    "rationale": "Swallowed exceptions hide bugs and make systems unpredictable",
    "minimum_action": ["log_error", "emit_metric", "set_status"],
    "examples": {
      "bad": "try: risky() except: pass",
      "acceptable": "try: risky() except ExpectedError: logger.debug('Expected condition')",
      "good": "try: risky() except UnexpectedError as e: logger.error(e); raise"
    }
  },
  {
    "type": "error_handling",
    "category": "pattern",
    "pattern": "result_type",
    "description": "Return success/failure as explicit types instead of throwing",
    "languages": ["rust", "go", "functional"],
    "rust_example": "fn divide(a: f64, b: f64) -> Result<f64, DivisionError>",
    "go_example": "func divide(a, b float64) (float64, error)",
    "benefits": ["explicit_error_handling", "no_hidden_control_flow", "composable"],
    "when_to_use": ["expected_failures", "recoverable_errors", "domain_errors"],
    "when_to_throw": ["programmer_errors", "unrecoverable", "infrastructure_failures"]
  },
  {
    "type": "error_handling",
    "category": "pattern",
    "pattern": "error_boundaries",
    "description": "Contain errors at defined boundaries, prevent cascade",
    "react_example": "ErrorBoundary component catches render errors in subtree",
    "backend_example": "Try-catch at controller level, return appropriate HTTP error",
    "benefits": ["graceful_degradation", "partial_failure_handling", "user_friendly_errors"],
    "implementation": {
      "identify": "Define system boundaries (API, component, module)",
      "catch": "Handle errors at boundary",
      "transform": "Convert to user-appropriate message",
      "log": "Log full details for debugging"
    }
  },
  {
    "type": "error_handling",
    "category": "pattern",
    "pattern": "retry_with_backoff",
    "description": "Retry transient failures with exponential backoff",
    "when_to_retry": ["network_timeout", "rate_limited", "temporary_unavailable"],
    "when_not_to_retry": ["validation_error", "authentication_failure", "not_found"],
    "algorithm": {
      "initial_delay": "100ms",
      "multiplier": 2,
      "max_delay": "30s",
      "max_attempts": 5,
      "jitter": "Add random 0-100ms to prevent thundering herd"
    },
    "implementation": "delay = min(initial * (multiplier ^ attempt) + jitter, max_delay)"
  },
  {
    "type": "error_handling",
    "category": "pattern",
    "pattern": "circuit_breaker",
    "description": "Stop calling failing service, fail fast instead",
    "states": {
      "closed": "Normal operation, requests pass through",
      "open": "Service failing, reject requests immediately",
      "half_open": "Test if service recovered"
    },
    "thresholds": {
      "failure_count": "Open after 5 failures in 1 minute",
      "success_count": "Close after 3 successes in half-open"
    },
    "fallback_options": ["cached_data", "default_value", "degraded_functionality", "queue_for_later"]
  },
  {
    "type": "error_handling",
    "category": "pattern",
    "pattern": "graceful_degradation",
    "description": "Provide reduced functionality when components fail",
    "examples": {
      "recommendation_service_down": "Show popular items instead of personalized",
      "payment_service_slow": "Queue order, process later",
      "search_service_down": "Show categories, disable search"
    },
    "implementation": ["feature_flags", "fallback_handlers", "timeout_with_default"],
    "user_communication": "Inform users of degraded state transparently"
  },
  {
    "type": "error_handling",
    "category": "logging",
    "pattern": "structured_error_logging",
    "description": "Log errors with consistent structure for analysis",
    "fields": {
      "timestamp": "ISO 8601 format",
      "level": "ERROR, WARN, etc",
      "message": "Human readable description",
      "error_code": "Machine readable identifier",
      "stack_trace": "Full trace for debugging",
      "context": "Request ID, user ID, relevant params",
      "service": "Service name and version"
    },
    "example": {
      "timestamp": "2024-01-15T10:30:00Z",
      "level": "ERROR",
      "message": "Payment processing failed",
      "error_code": "PAYMENT_DECLINED",
      "request_id": "req-123",
      "user_id": "user-456",
      "amount": 99.99
    }
  },
  {
    "type": "error_handling",
    "category": "user_facing",
    "pattern": "user_friendly_errors",
    "description": "Transform technical errors into helpful user messages",
    "principles": [
      "Never expose stack traces or internal details",
      "Explain what went wrong in plain language",
      "Suggest what user can do next",
      "Provide way to get help (support, docs)"
    ],
    "mapping": {
      "ConnectionError": "We're having trouble connecting. Please check your internet and try again.",
      "ValidationError": "Some information needs to be corrected. Please check the highlighted fields.",
      "AuthenticationError": "Please sign in to continue.",
      "RateLimitError": "You're doing that too often. Please wait a moment and try again.",
      "InternalError": "Something went wrong on our end. We've been notified and are working on it."
    },
    "include_request_id": "Reference: ERR-123-ABC (for support)"
  },
  {
    "type": "error_handling",
    "category": "testing",
    "pattern": "chaos_engineering",
    "description": "Intentionally inject failures to test error handling",
    "techniques": {
      "network": "Inject latency, drop packets, partition",
      "service": "Kill instances, return errors",
      "resource": "Exhaust CPU, memory, disk",
      "clock": "Skew time, freeze"
    },
    "tools": ["chaos_monkey", "toxiproxy", "gremlin", "litmus"],
    "principles": [
      "Start small in non-production",
      "Have hypothesis about expected behavior",
      "Automate and run regularly",
      "Fix issues before moving to production"
    ]
  },
  {
    "type": "error_handling",
    "category": "monitoring",
    "pattern": "error_tracking",
    "description": "Aggregate and analyze errors across the system",
    "tools": ["sentry", "rollbar", "bugsnag", "datadog"],
    "features": {
      "grouping": "Deduplicate similar errors",
      "alerting": "Notify on new or spiking errors",
      "context": "Capture request, user, environment",
      "trends": "Track error rate over time"
    },
    "metrics": ["error_rate", "error_budget", "mttr", "error_by_type"],
    "slo_example": "99.9% of requests succeed (error budget: 0.1%)"
  }
]
